这部分主要比较在传统虚拟机环境和云原生容器环境下应用服务的完成同样任务时的效率和资源消耗。

虚拟机技术是一种通过软件模拟完整的硬件系统功能的计算机系统，它运行在一个完全隔离的环境中。当我们创建虚拟机时，需要将物理环境中的存储和内存容量作为虚拟机的存储和内存容量，每个虚拟机都有着独立的CMOS、计算（CPU/内存）、网络、存储和操作系统，可以像使用物理机一样对虚拟机进行操作。

虚拟机管理程序允许多个租户将孤立的虚拟机部署在同一台物理机器上，实现了共享硬件基础架构。虚拟机模拟了计算机体系结构的计算机系统，并提供了物理计算机的功能。这种技术大大提高了底层物理机器的利用率。相比之下，云原生容器技术是在内核层对资源进行共享，由kernel对容器进程进行资源分配，无论是效率和能耗都比虚拟机要好很多。

例如，使用KVM的Hypervisor层报告开销介于9-12％之间，这意味着KVM下的客户机操作系统通常从可用CPU的88-91％开始。当在Hyper-V下运行的操作系统被观察到在主存储器的大约90%时，存储器无法再进行申请或者出现内存溢出错误。当然，在客户操作系统上运行进程可能会因缺乏资源而受到影响，并且效率低于直接在主机（物理服务器）操作系统上运行相同进程的效率。

考虑到这种虚拟化开销，容器的工作方式及其好处是直接在主机上运行容器的重要原因。

容器为虚拟机（VM）提供了一种轻量级的代替方案。容器可以将您的应用程序隔离在其自己的运行环境中，无论它在何处运行。与虚拟机不同，容器只会安装应用程序所需的依赖项，而不会添加任何其他东西。容器使开发人员能够在相同的开发环境和堆栈中工作，并能够在容器中进行开发，而无需构建和运行虚拟机，因为它提供了独立的网络堆栈和存储。此外，容器有助于持续集成和交付流程，并鼓励无状态设计。总而言之，容器比虚拟机更加灵活、高效和节约资源。

虚拟机也可以使用和容器一样的方式，但它们存在着几个明显的缺点。最主要的是，虚拟化需要经过中间层（Hypervisor）进行转换，这会带来一定的开销。无论部署的guest虚拟机操作系统（OS）有多精简，每次创建新的虚拟机时都需要完全复制整个操作系统及其配置，这会导致虚拟机性能相对较低。容器则在虚拟机或裸机主机操作系统之上运行自身的初始化进程、文件系统和网络堆栈，因此在原理上使用的内存要比虚拟机少。这是因为容器之间原生的会共享OS内核，并且通常使用相同的库。

本文比较了四种静态场景下采用云原生容器和传统虚拟机的方式所占用的资源和能耗（执行速度越快相对能耗就会越低）：

|                 | **静态存储占用** | **执行效率****(能耗)** |                  |
| --------------- | ---------------- | ---------------------- | ---------------- |
|                 | **虚拟机**       | **容器**               | **容器比虚拟机** |
| 标准压缩        | 1.5G             | 359M                   | 快18%            |
| Redis内存数据库 | 2.0G             | 117M                   | 快29%            |
| Nginx代理服务   | 4.5G             | 142M                   | 快46%            |
| Tomcat Web服务  | 3.3G             | 142M                   | 快14%            |